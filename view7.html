<!DOCTYPE html>
<html lang="en" >

 <head>
  <meta charset="utf-8" />
  <meta name="DC.creator" content="Ruven Pillay &lt;ruven@users.sourceforge.netm&gt;"/>
  <meta name="DC.title" content="IIPMooViewer 2.0: HTML5 High Resolution Image Viewer"/>
  <meta name="DC.subject" content="IIPMooViewer; IIPImage; Visualization; HTML5; Ajax; High Resolution; Internet Imaging Protocol; IIP"/>
  <meta name="DC.description" content="IIPMooViewer is an advanced javascript HTML5 image viewer for streaming high resolution scientific images"/>
  <meta name="DC.rights" content="Copyright &copy; 2003-2012 Ruven Pillay"/>
  <meta name="DC.source" content="http://iipimage.sourceforge.net"/>
  <meta name="viewport" content="width=device-width; initial-scale=1.0; maximum-scale=1.0; user-scalable=0;" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <meta http-equiv="X-UA-Compatible" content="IE=9" />

  <link rel="stylesheet" type="text/css" media="all" href="css/iip2.css" />
<!--[if lt IE 10]>
  <link rel="stylesheet" type="text/css" media="all" href="css/ie.compressed.css" />
<![endif]-->

  <link rel="shortcut icon" href="images/iip-favicon.png" />
  <link rel="apple-touch-icon" href="images/iip.png" />

  <title>IIPMooViewer 2.0 :: HTML5 High Resolution Image Viewer</title>

  <script type="text/javascript" src="js/mootools-core-1.4.5-full-nocompat-yc.js"></script>
  <script type="text/javascript" src="js/mootools-more-1.4.0.1-compressed.js"></script>
  <script type="text/javascript" src="js/iipmooviewer-2.0.7.js"></script>
  <script type="text/javascript" src="js/annotation4.js"></script>

<!--[if lt IE 7]>
  <script src="http://ie7-js.googlecode.com/svn/version/2.1(beta4)/IE7.js">IE7_PNG_SUFFIX = ".png";</script>
<![endif]-->

  <script type="text/javascript">

    // The *full* image path on the server. This path does *not* need to be in the web
    // server root directory. On Windows, use Unix style forward slash paths without
    // the "c:" prefix
    var IP='http://localhost';
    var image = '/usr/share/iip/3.tif';
    var annot = new Array();
    annot.push( {x: 0.38, y: 0.28, w: 0.14, h: 0.06,type:"rect", text: "<div style='width:300px'><blockquote>« Ce tableau, qui a beaucoup souffert, est cependant encore d’un grand mérite ;la passion est peinte dans les yeux de ces amants. Quelle belle couleur ! Quelle vérité ! C’est de la chair et l’on conçoit aisément l’illusion qu’il pouvait faire en sortant des mains de ce grand maître. »</blockquote>Ce témoignage du peintre François-Bernard Lépicié (1698-1755), secrétaire perpétuel et historiographe de l’Académie royale de peinture et de sculpture, constitue la première description que nous ayons du tableau de Titien à partir du moment où celui-ci entre dans la collection de Louis XIV en 1662.</div>"} );

    annot.push( {x: 0.32, y: 0.7, w: 0.05, h: 0.05, type:"rect", text: "<div style='width:300px'>La masse de la chevelure est traité de manière très sensuelle et une trace de doigt court le long d’une mèche de la Femme à sa Toilette.</div>"} );


    // Copyright or information message
    var credit = '&copy; copyright or information message';

    // Create our viewer object
    // See documentation for more details of options
    var iip= new IIPMooViewer( "viewer", {
	image: image,
	credit: credit
    });
    iip.annotations=annot;
  </script>

  <style type="text/css">
    body{
	height: 100%;
	padding: 0;
	margin: 0;
    }
    div#viewer{
	height: 100%;
	min-height: 100%;
	width: 100%;
	position: absolute;
	top: 0;
	left: 0;
	margin: 0;
	padding: 0;
    }	
    div#meta{
	position:absolute;
	width:100%;
	height:15px;
	bottom:0%;
	color:white
    }
    .slider
    {
          margin: 1px;
	  border: 1px outset #333;
	  color: #fff;
	  background: #222;
	  opacity: 0.85;
	  font-weight: normal;
	  padding: 1px;
	  font-size: 80%;
	  -moz-border-radius: 0.3em;
	  -webkit-border-radius: 0.3em;
	  border-radius: 0.3em;
	  -moz-box-shadow: 4px 4px 4px rgba(0,0,0,0.75);
	  -webkit-box-shadow: 4px 4px 4px rgba(0,0,0,0.75);
	  -o-box-shadow: 4px 4px 4px rgba(0,0,0,0.75);
	  box-shadow: 4px 4px 4px rgba(0,0,0,0.75);
	  text-shadow: 0.5px 0.5px 0 grey;
    }
    .tiplayer
    {
	position:absolute;
	top:80%;
	left:40%;
	z-index:2;
    }
	ul {
		list-style-type: none;
		padding-left: 0;
		margin-left: 0;
	}
	li {
		background: left center no-repeat;
		margin-bottom: 2px;
	}

	.selected
	{
	   background: #fff;
	   cursor: pointer;
	}
	.imgselected
	{
	   background: #ccc;
	   cursor: pointer;
	}
	.patientname
	{
	  color:#000;
	  background: #fff;
	}
	.patientage
	{
	  background: #01f;
	}
	.modality
	{
	  color:#fff;
	  background: #000;
	}
  </style>

 </head>

 <body>
   <div id="viewer"></div>
   <div id="meta" class="slider" style="position:absolute;width:100%;height:15px;bottom:0%;color:white;z-index:5">
        <hr id="v_toggle"/>
        <div id="metadata"></div>
   </div>
   <div id="show" style="position:absolute;width:20px;height:40px;left:40px;top:10px;z-index:5">   
   </div>
   <div style="position:absolute;color:white;left:40px;top:10px;z-index:5">
        <div id="h_slide" style="width:150px">
	<img id="rect" title="rectangle" src="images/rect.svg"><img id="ellipse" title="ellipse" src="images/ellipse.svg"><img id="polyline" title="polyline" src="images/poly.svg"><img id="pencil" title="pencil" src="images/pencil.svg"><img id="measure" title="Measure Distance" src="images/measure.svg"><img id="hide" title="hide/show Editing" src="images/hide.svg">
        </div>
  </div>
   <script>
            var a= new Fx.Slide('h_slide',{mode:'horizontal'});
            a.slideOut().chain(function(){ 
	    $("show").addEvent('mouseover', function(event){
	    event.stop();
	    $("polyline").addEvent('click',function(){iip.drawMarkups('polyline');a.slideOut();});	
	    $("rect").addEvent('click',function(){iip.drawMarkups('rect');a.slideOut();});
	    $("pencil").addEvent('click',function(){iip.drawMarkups('pencil');a.slideOut();});
	    $("ellipse").addEvent('click',function(){iip.drawMarkups('ellipse');a.slideOut();});
	    $("measure").addEvent('click',function(){iip.drawMarkups('measure');a.slideOut();});
      	    $("hide").addEvent('mouseover',function(){iip.svg.toggle();});
	    $("hide").addEvent('click',function(){a.slideOut();this.removeEvent('mouseover');this.removeEvent('click');});			
	    a.slideIn();
            $("h_slide").addClass("slider");
	  });});
        
     var myElement = $("meta");
		myElement.set('tween', {
		    duration: 'long',
		    transition: 'bounce:out',
		    link: 'cancel'
		});
               $('v_toggle').addEvent('mouseover',function(event){
                  event.stop();
                  if($("meta").style.height=='15px')
                  {     
    		        myElement.tween('height', 15, 100);
	                var jsonRequest = new Request.JSON({url: IP+'/bio/api/test.php', onSuccess: function(imageList){
                        moreImage(imageList,0);}}).get();
                  }
                  else
                  {
    		     myElement.tween('height', 100, 15);
                     $("metadata").set('html','');
		  }
               });
function displayImage(imagelocation)//disply image according to the image location
{
   window.location="view6.html?"+imagelocation;
}
function moreImage(imageList,k)
{
        var metadata=$("metadata");
	$("metadata").set('html','');
        if(k>=9)
        {
             var imageElement=new Element('div',{
		      'class':'imageInfo',
                      'style':'position:absolute;width:10%;left:2%',
		      html:'<<',
		      events:{'click':function(){moreImage(imageList,k-9);},'mouseenter':function(){this.addClass('imgselected')},'mouseleave':function(){this.removeClass('imgselected')}}
		      });
		imageElement.inject(metadata);
        }
        if(imageList.length<(k+9))
        {
		for (var i=k;i<imageList.length;i++)
		{
		      var image = imageList[i];
		      var imageElement=new Element('ul',{
		      'class':'imageInfo',
                      'style':'position:absolute;width:10%;left:'+((i-k)*10+5)+'%',
		      html:'<li class="patientname">'+image["PatientName"]+'</li><li class="patientage">'+image["PatientAge"]+'</li><li class="modality">'+image["ImageModality"]+'</li>',
		      events:{'click':function(){displayImage(image["ImageLocation"])},'mouseenter':function(){this.addClass('imgselected')},'mouseleave':function(){this.removeClass('imgselected')}}
		      });
		      imageElement.inject(metadata);
		}
        }
        else
	{
		
		for (var i=k;i<(k+9);i++)
		{
		      var image = imageList[i];
		      var imageElement=new Element('ul',{
		      'class':'imageInfo',
                      'style':'position:absolute;width:10%;left:'+((i-k)*10+5)+'%',
		      html:'<li class="patientname">'+image["PatientName"]+'</li><li class="patientage">'+image["PatientAge"]+'</li><li class="modality">'+image["ImageModality"]+'</li>',
		      events:{'click':function(){displayImage(image["ImageLocation"])},'mouseenter':function(){this.addClass('imgselected')},'mouseleave':function(){this.removeClass('imgselected')}}
		      });
		      imageElement.inject(metadata);
		}
                var imageElement=new Element('div',{
		      'class':'imageInfo',
                      'style':'position:absolute;width:10%;left:95%',
		      html:'>>',
		      events:{'click':function(){moreImage(imageList,k+9);},'mouseenter':function(){this.addClass('imgselected')},'mouseleave':function(){this.removeClass('imgselected')}}
		      });
		imageElement.inject(metadata);
	}
}
   </script>
 </body>

</html>
